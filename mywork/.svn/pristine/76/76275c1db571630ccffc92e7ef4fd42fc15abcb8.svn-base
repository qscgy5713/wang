<include file="Common:header"/>

<div id="page-container" class="fade page-sidebar-fixed page-header-fixed">
	<include file="Common:menu"/>
	<include file="Common:menu2"/>
	<div class="sidebar-bg"></div>

	<div id="content" class="content">
		<form class="m-b-0" id="formInquire" method="post" action='__APP__/{$Think.MODULE_NAME}/{$Think.ACTION_NAME}'>
        
			<div class="row">
				
				<div class="row col-lg-6 col-xl-4 p-r-0 p-l-0 m-r-0 m-l-0 m-b-10">
                  
                  <div class="m-auto">
                    <input class="btn btn-info p-10 f-s-13 time-btn-rwd time-btn-rwd-p" style="width:100%;" type="button" value="今日" onClick="formTime('{$today} 00:00:00','{$today} 23:59:59')"/>
                  </div>
                 
                  <div class="m-auto">
                    <input class="btn btn-info p-10 f-s-13 time-btn-rwd time-btn-rwd-p" style="width:100%;" type="button" value="昨日" onClick="formTime('{$yesterday} 00:00:00','{$yesterday} 23:59:59')"/>
                  </div>
                  
                  <div class="m-auto">
                    <input class="btn btn-info p-10 f-s-13 time-btn-rwd time-btn-rwd-p" style="width:100%;" type="button" value="明日" onClick="formTime('{$tomorrow} 00:00:00','{$tomorrow} 23:59:59')"/>
                  </div>
                  
                  <div class="m-auto">
                    <input class="btn btn-info p-10 f-s-13 time-btn-rwd time-btn-rwd-p" style="width:100%;" type="button" value="本週" onClick="formTime('{$thisWeekA} 00:00:00','{$thisWeekB} 23:59:59')"/>
                  </div>
                  
                  <div class="m-auto">
                    <input class="btn btn-info p-10 f-s-13 time-btn-rwd time-btn-rwd-p" style="width:100%;" type="button" value="上週" onClick="formTime('{$lastWeekA} 00:00:00','{$lastWeekB} 23:59:59')""/>
                  </div>
                  
                  <div class="m-auto">
                    <input class="btn btn-info p-10 f-s-13 time-btn-rwd time-btn-rwd-p" style="width:100%;" type="button" value="本月" onClick="formTime('{$thisMonthA} 00:00:00','{$thisMonthB} 23:59:59')"/>
                  </div>
                  
                  <div class="m-auto">
                    <input class="btn btn-info p-10 f-s-13 time-btn-rwd time-btn-rwd-p" style="width:100%;" type="button" value="上月" onClick="formTime('{$lastMonthA} 00:00:00','{$lastMonthB} 23:59:59')"/>
                  </div>
				</div>
                
				<div class="row col-lg-6 col-xl-4 p-r-5 p-l-5 m-r-0 m-l-0 m-b-10">
                  <div class="col-5 p-0">
                    <input id="startTime" name="startTime" type="text" class="form-control div-style" style="width:100%;" autocomplete="off" value="{$startTime}"/>
                  </div>
                  <div class="col-2 text-center p-0"><label class="p-5">至</label></div>
                  <div class="col-5 p-0">
                    <input id="endTime"   name="endTime" type="text" class="form-control div-style" style="width:100%;" autocomplete="off" value="{$endTime}"/>
                  </div>
				</div>
				
				<div class="row col-lg-12 col-xl-4 p-r-5 p-l-5 m-r-0 m-l-0">
                  <div class="col-3 col-md-2 col-xl-3 p-0 m-b-0"><label class="p-5">搜索帳號:</label></div>
                  
                  <div class="col-9 col-md-7 col-xl-6 p-r-0 p-l-0 m-b-0">
                    <input class="form-control" style="width:100%;" type="text" name="searchMemberAccount" id="searchMemberAccount" placeholder="請填寫完整會員帳號" value='{$searchMemberAccount}' >
                  </div>
                  
                  <div class="row col-12 col-md-3 col-xl-2 p-r-0 p-l-0 m-r-0 m-l-0">
                    <div class="col-md-12 col-xl-10 p-l-0 p-r-0 m-b-0"><input class="btn btn-info p-r-0 p-l-0 m-r-5 m-l-5" style="width:100%;" type='submit' value='查詢'></div>
                    
                    <input id="agentTree" type='hidden' name='agentTree' value='{$comeAgentTree}'>
				    <input id="agentAccount" type='hidden' name='agentAccount' value='{$comeAgentAccount}'>
				    <input id="gameCode" type='hidden' name='gameCode' value=''>
				    <input id="gameName" type='hidden' name='gameName' value='{$gameName}'>
					
                  </div>
				</div>
				<!--
				<div class="row col-lg-6 col-xl-4 p-r-5 p-l-5 m-r-0 m-l-0 m-b-10">
                  <div class="col-12 p-0 text-center">
                    <select class="selectpicker" multiple name="gameShowListArray[]">
                    	<optgroup label="Picnic">
						    <option>Mustard</option>
						    <option>Ketchup</option>
						    <option>Relish</option>
					    </optgroup>
					    <VOLIST name="gameListArray" id="vo">
					    	<IF condition='$vo.gameEnable eq "1"'>
					    		<option value="{$vo.gameCode}" selected = "selected">{$vo.gameName}</option>
							<ELSE/>
								<option value="{$vo.gameCode}" >{$vo.gameName}</option>
							</IF>
					    </VOLIST>
				   </select>
                  </div>
                 
				</div> -->
				
			</div>
			
			<!-- <div class="row m-b-10">
				
			</div> -->
			
		</form>
		
		<div class="form-group row m-b-15 p-l-15">
			<ol class="breadcrumb pull-left">
				<VOLIST name="loginArray" id="vo">
					<li class="breadcrumb-item">
						
						<a href="javascript:;" onclick="formAgent('{$vo.agentAccount}','{$vo.agentTree}')" class="btn btn-default btn-xs m-r-5 m-b-5 loginArray-btn">
							{$vo.agentAccount}
						</a>
					</li>
				</VOLIST>
			</ol>
		</div>

		<div class="row">
			<div class="col-lg-12 ui-sortable">
				<!-- begin panel -->
				<div class="panel panel-inverse" data-sortable-id="table-basic-1">
					<!-- begin panel-heading -->
					<div class="panel-heading ui-sortable-handle" data-click="panel-collapse"> 
						<div class="panel-heading-btn">
							<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning"><i class="fa fa-minus"></i></a>
						</div>
						<h4 class="panel-title f-s-15">遊戲帳務</h4>
					</div>
					<!-- end panel-heading -->

					<!-- begin panel-body -->
					<div class="panel-body">
						<!-- begin table-responsive -->
						<div class="table-responsive">
							<table class="table table-striped m-b-0">
							   <thead>
							   	 <tr style="background-color: rgba(0, 188, 212, 0.19);">
								   	 <td colspan="2" class="f-w-600">總計</td>
								   	 <th>{$gameTotalBettingMoney|number_format=0}</th>
									 <th style='color: {$gameTotalSurplus>=0?'green':'red'}'>{$gameTotalSurplus|number_format=0}</th>
									 <th>{$gameTotalEffective|number_format=0}</th>
									 <th>{$gameTotalBetNumber|number_format=0}</th>
							   	 </tr>
			                     <tr style="background-color: rgba(0, 188, 212, 0.19);">
				                      <th>序</th>
				                      <th>遊戲名稱</th>
				                      <th>投注金額</th>
				                      <th>輸贏金額</th>
				                      <th>有效注額</th>
				                      <th>注單數量</th>
			                      </tr>
				                </thead>
								<tbody>
									<VOLIST name="gameShowArray" id="vo" empty="$gameShowEmpty">
										<tr>
											<td>{$i}</td>
											<td>
												<input type='button' value="{$key}" class="btn btn-info f-s-13" style="width: 80px;" onClick="openGameReport('{$vo.game_code}','{$comeAgentTree}','{$key}')">
											</td>
											<td>{$vo.allBettingMoney|number_format=0}</td>
											<td style='color: {$vo['allSurplus']>=0?'green':'red'}'>{$vo.allSurplus|number_format=0}</td>
											<td>{$vo.allEffective|number_format=0}</td>
											<td>{$vo.allBetNumber|number_format=0}</td>
										</tr>
									</VOLIST>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>




		<div class="row">
			<div class="col-lg-12 ui-sortable">
				<!-- begin panel -->
				<div class="panel panel-inverse" data-sortable-id="table-basic-1">
					<!-- begin panel-heading -->
					<div class="panel-heading ui-sortable-handle" data-click="panel-collapse"> 
						<div class="panel-heading-btn">
							<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning"><i class="fa fa-minus"></i></a>
						</div>
						<h4 class="panel-title f-s-15">子代理帳務</h4>
					</div>
					<!-- end panel-heading -->

					<!-- begin panel-body -->
					<div class="panel-body">
						<!-- begin table-responsive -->
						<div class="table-responsive">
							<table id="agentTable" class="table table-striped m-b-0">
								<thead>
								   	 <tr style="background-color: rgba(0, 188, 212, 0.19);">
									   	 <td colspan="5" class="f-w-600 text-black-transparent-9">總計</td>
									   	 <th>{$agentTotalBettingMoney|number_format=0}</th>
										 <th style='color: {$agentTotalSurplus >=0?'green':'red'}'>{$agentTotalSurplus|number_format=0}</th>
										 <th>{$agentTotalEffective|number_format=0}</th>
										 <th>{$agentTotalBetNumber|number_format=0}</th>
										 <IF condition='$boolSelectOther eq true'>
										 	 <th>{$agentTotalGiven|number_format=0}</th>
											 <th>{$agentTotalHandlingFee|number_format=0}</th>
											 <th style='color: {$agentTotalSettlement >=0?'green':'red'}'>{$agentTotalSettlement|number_format=0}</th>
											 <th style='color: {$agentTotalTopDebit >=0?'green':'red'}'>{$agentTotalTopDebit|number_format=0}</th>
										 </IF>
								   	 </tr>
				                     <tr style="background-color: rgba(0, 188, 212, 0.19);">
					                      <th>序</th>
					                      <th>代理</th>
					                      <th>佔成備註</th>
					                      <th>佔成</th>
					                      <th>下線佔成</th>
					                      <th>投注金額</th>
					                      <th>輸贏金額</th>
					                      <th>有效注額</th>
					                      <th>注單數量</th>
					                      <IF condition='$boolSelectOther eq true'>
						                      <th>贈點</th>
						                      <th>手續費</th>
						                      <th>下級交收</th>
						                      <th>上級交收</th>
					                      </IF>
				                      </tr>
					                </thead>
									<tbody>
										<VOLIST name="agentArray" id="vo" empty="$agentEmpty">
											<tr>
												<td>{$i}</td>
												<td>
													<input class="btn btn-info f-s-13" style="width: 80px;" type='button' value='{$vo.agentAccount}' onclick="formAgent('{$vo.agentAccount}','{$vo.agentTree}')">
												</td>
												<td>{$vo.ratioRemark}</td>
												<td>{$vo.agentRatio}%</td>
												<td>{$vo.underRatio}%</td>
												<td>{$vo.sumBettingMoney|number_format=0}</td>
												<td style='color: {$vo['sumSurplus']>=0?'green':'red'}'>{$vo.sumSurplus|number_format=0}</td>
												<td>{$vo.sumEffective|number_format=0}</td>
												<td>{$vo.sumBetNumber|number_format=0}</td>
												<IF condition='$boolSelectOther eq true'>
													<td>
														<input class="btn btn-info f-s-13" style="width: 80px;" type='button' value='{$vo.sumGivenMoney|number_format=0}' onclick="openGiveReport('{$vo.agentAccount}','{$vo.agentTree}')">
														<!-- {$vo.sumGivenMoney|number_format=0} -->
													</td>
													<td>{$vo.sumHandlingFee|number_format=0}</td>
													<td style='color: {$vo['sumSettlement']>=0?'green':'red'}'>{$vo.sumSettlement|number_format=0}</td>
													<td style='color: {$vo['topDebit']>=0?'green':'red'}'>{$vo.topDebit|number_format=0}</td>
												</IF>
											</tr>
										</VOLIST>
									</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-lg-12 ui-sortable">
				<!-- begin panel -->
				<div class="panel panel-inverse" data-sortable-id="table-basic-1">
					<!-- begin panel-heading -->
					<div class="panel-heading ui-sortable-handle" data-click="panel-collapse"> 
						<div class="panel-heading-btn">
							<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning"><i class="fa fa-minus"></i></a>
						</div>
						<h4 class="panel-title f-s-15">{$comeAgentAccount} 會員帳務</h4>
					</div>
					<!-- end panel-heading -->

					<!-- begin panel-body -->
					<div class="panel-body">
						<!-- begin table-responsive -->
						<div class="table-responsive">
							<table id="memberTable" class="table table-striped m-b-0">
							   <thead>
							   	 <tr style="background-color: rgba(0, 188, 212, 0.19);">
								   	 <td colspan="3" class="f-w-600 text-black-transparent-9">總計</td>
								   	 <th>{$memberTotalBettingMoney|number_format=0}</th>
									 <th style='color: {$memberTotalSurplus >=0?'green':'red'}'>{$memberTotalSurplus|number_format=0}</th>
									 <th>{$memberTotalEffective|number_format=0}</th>
									 <th>{$memberTotalBetNumber|number_format=0}</th>
									 <IF condition='$boolSelectOther eq true'>
									 	 <th>{$memberTotalGiven|number_format=0}</th>
										 <th>{$memberTotalHandlingFee|number_format=0}</th>
										 <th style='color: {$memberTotalTopDebit >=0?'green':'red'}'>{$memberTotalTopDebit|number_format=0}</th>
									 </IF>
							   	 </tr>
			                     <tr style="background-color: rgba(0, 188, 212, 0.19);">
				                      <th>序</th>
				                      <th>會員</th>
				                      <th>佔成</th>
				                      <th>投注金額</th>
				                      <th>輸贏金額</th>
				                      <th>有效注額</th>
				                      <th>注單數量</th>
				                      <IF condition='$boolSelectOther eq true'>
				                          <th>贈點</th>
					                      <th>手續費</th>
						                  <th>上級交收</th>
				                      </IF>
			                      </tr>
				                </thead>
								<tbody>
									<VOLIST name="memberArray" id="vo" empty="$memberEmpty">
										<tr>
											<td>{$i}</td>
											<td>
												<input type='button' value="{$vo.memberAccount}" style="width: 80px;" class="btn btn-info f-s-13 p-5" onClick="openMemberReport('{$vo.memberAccount}')">
											</td>
											<td>{$vo.agentRatio}%</td>
											<td>{$vo.sumBettingMoney}</td>
											<td style='color: {$vo['sumSurplus']>=0?'green':'red'}'>{$vo.sumSurplus|number_format=0}</td>
											<td>{$vo.sumEffective|number_format=0}</td>
											<td>{$vo.sumBetNumber|number_format=0}</td>
											<IF condition='$boolSelectOther eq true'>
												<td>{$vo.sumGivenMoney|number_format=0}</td>
												<td>{$vo.sumHandlingFee|number_format=0}</td>
												<td style='color: {$vo['topDebit']>=0?'green':'red'}'>{$vo.topDebit|number_format=0}</td>
											</IF>
										</tr>
									</VOLIST>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<a href="javascript:;" class="btn btn-icon btn-circle btn-success btn-scroll-to-top fade" data-click="scroll-top"><i class="fa fa-angle-up"></i></a>
</div>
<include file="Common:footer"/>

<script>
$(function () { $('#memberDetailDiv').on('hide.bs.modal', function () {
	 $("#memberDetailIframe").attr("src", "__APP__/Common/loading");
 })
});
$(function () { $('#gameDetailDiv').on('hide.bs.modal', function () {
	 $("#gameDetailIframe").attr("src", "__APP__/Common/loading");
 })
});

function openMemberReport(memberAccount){
	$("#searchMemberAccount").val(memberAccount);
	$("#formInquire").attr("action", "__APP__/{$Think.MODULE_NAME}/memberDetail");
	$("#formInquire").submit();
}
function openGameReport(gameCode,agentTree,gameName){
	$("#gameName").val(gameName);
	$("#gameCode").val(gameCode);
	$("#agentTree").val(agentTree);
	$("#formInquire").attr("action", "__APP__/{$Think.MODULE_NAME}/gameDetail");
	$("#formInquire").submit();
}
$(function(){
	if("{$searchMemberErr}" == 'true'){
		errorMsgShow("{$searchMemberErrMessage}");
	}
	
	datetimePicker("startTime","endTime","endTime","startTime");
});
function formTime(startTime,endTime){
	$("#startTime").val(startTime);
	$("#endTime").val(endTime);
	$("#agentTree").val('');
	$("#formInquire").submit();
}
function formAgent(agentAccount,agentTree){
	$("#searchMemberAccount").val('');
	$("#agentAccount").val(agentAccount);
	$("#agentTree").val(agentTree);
	$("#formInquire").submit();
}
function openGiveReport(agentAccount,agentTree){
	$("#searchMemberAccount").val('');
	$("#agentAccount").val(agentAccount);
	$("#agentTree").val(agentTree);
	$("#formInquire").attr("action", "__APP__/{$Think.MODULE_NAME}/giveDetail");
	$("#formInquire").submit();
}
</script>
